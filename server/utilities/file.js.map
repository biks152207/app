{"version":3,"sources":["utilities/file.js"],"names":["Uploader","form","IncomingForm","multiples","uploadDir","join","__dirname","req","deferred","defer","on","field","file","fs","rename","path","name","error","console","log","reject","resolve","parse"],"mappings":";;;;;QAYgBA,Q,GAAAA,Q;;AAZhB;;;;AACA;;;;AACA;;;;;;AACA;AACA,IAAMC,OAAO,IAAI,qBAAWC,YAAf,EAAb;AACA;AACAD,KAAKE,SAAL,GAAiB,IAAjB;;AAEA;AACAF,KAAKG,SAAL,GAAiB,eAAKC,IAAL,CAAUC,SAAV,EAAqB,UAArB,CAAjB;;AAGO,SAASN,QAAT,CAAkBO,GAAlB,EAAsB;AAC3B,MAAIC,WAAW,YAAEC,KAAF,EAAf;;AAEA;AACA;AACAR,OAAKS,EAAL,CAAQ,MAAR,EAAgB,UAASC,KAAT,EAAgBC,IAAhB,EAAqB;AACnCC,OAAGC,MAAH,CAAUF,KAAKG,IAAf,EAAqB,eAAKV,IAAL,CAAUJ,KAAKG,SAAf,EAA0BQ,KAAKI,IAA/B,CAArB;AACD,GAFD;;AAIA;AACAf,OAAKS,EAAL,CAAQ,OAAR,EAAiB,UAASO,KAAT,EAAe;AAC9BC,YAAQC,GAAR,CAAY,0BAA0BF,KAAtC;AACAT,aAASY,MAAT;AACD,GAHD;;AAKA;AACAnB,OAAKS,EAAL,CAAQ,KAAR,EAAe,YAAU;AACvBF,aAASa,OAAT;AACD,GAFD;AAGA;AACApB,OAAKqB,KAAL,CAAWf,GAAX;AAED","file":"utilities/file.js","sourcesContent":["import formidable from 'formidable';\nimport path from 'path';\nimport Q from 'q';\n// Create incoming form object\nconst form = new formidable.IncomingForm();\n// Allows multiple file to upload\nform.multiples = true;\n\n// Upload all the files in the /upload directory\nform.uploadDir = path.join(__dirname, '/uploads');\n\n\nexport function Uploader(req){\n  var deferred = Q.defer();\n\n  // Every time a file has been uploaded successfully\n  // Rename the file to it's original name\n  form.on('file', function(field, file){\n    fs.rename(file.path, path.join(form.uploadDir, file.name));\n  })\n\n  // Logs any error while uploading\n  form.on('error', function(error){\n    console.log('An error occurred: \\n' + error);\n    deferred.reject();\n  });\n\n  // Once all the files have been uploaded, send the reponse to the client\n  form.on('end', function(){\n    deferred.resolve();\n  });\n  // Parse the incoming request containing the form data\n  form.parse(req);\n\n}"],"sourceRoot":"/source/"}